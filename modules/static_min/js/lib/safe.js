!function(){"use strict";function n(n){return function(t){var r=A.apply(1,arguments),e=this,u=function(){var r=A.apply(0,arguments),u=r.pop();n(t,function(n,t){return n.apply(e,r.concat([t]))},u)};return r.length?u.apply(e,r):u}}var t,r="undefined",e="object",u="function",i="number",o={},c="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this,f=Array,a=Object,s=Function,l=c?c.safe:t,p=a.prototype.toString,y=a.prototype.hasOwnProperty,h=["Array or Object are required","Array is required","Exactly two arguments are required","Function is required"],g={_debugger:!1};o.noConflict=function(){return c.safe=l,this};var d,v=function(n){return n instanceof s||"[object Function]"===p.call(n)},m=function(n){return typeof n===r},_=function(n){return"[object Object]"===p.call(n)},k=function(n){return n instanceof f||"[object Array]"===p.call(n)},b=function(n){return n&&(k(n)||_(n))},w=function(n){return typeof n===i?Math.floor(n):parseInt(n,10)},S=function(n,t){for(var r,e=O(n);null!==(r=e())&&t(n[r],r,n)!==!1;);},j=function(n,r){var e,u=f(n.length),i=O(n);if(v(r))for(;null!==(e=i());)u[e]=r(n[e],e,n);else for(;null!==(e=i());)u[e]=n[e]?n[e][r]:t;return u},x=function(){return a.keys?function(n){return k(n)?n.length:a.keys(n).length}:function(n){if(k(n))return n.length;var t=0;for(var r in n)y.call(n,r)&&++t;return t}}(),L=a.keys||function(n){if(typeof n!==e&&(typeof n!==u||null===n))throw new TypeError("Object.keys called on non-object");var t=x(n),r=f(t),i=-1;if(k(n))for(;++i<t;)r[i]=i;else for(var o in n)y.call(n,o)&&(r[++i]=o);return r},E=function(n){return n!==n},O=function(n){var t,r,e=-1;return k(n)?(r=n.length,function(){return++e,r>e?e:null}):(t=L(n),r=t.length,function(){return++e,r>e?t[e]:null})};d=typeof setImmediate===r?typeof process===r?typeof Promise===u?function(n){var t=new n(function(n,t){n()});return function(n){t.then(function(){n()})}}(Promise):typeof Image===u?function(n){return function(t){var r=new n;r.onerror=function(){t()},r.src="data:image/png,0"}}(Image):function(n){setTimeout(n,0)}:process.nextTick:function(n){setImmediate(n)};var I=function(n){var t=this,r=A.apply(1,arguments);d(function(){n.apply(t,r)})},P=function(){},q=function(n,t){var r=-1!==h.indexOf(n)?new TypeError(n):new Error(n);if(!v(t))throw r;t(r)},A=function(){var n=arguments.length,t=w(this);if(E(t)&&q('Pass arguments to "safe.args" only through ".apply" method!'),0===n||t>n)return[];for(var r=f(n-t),e=t-1;++e<n;)r[e-t]=0>e?null:arguments[e];return r},T=function(n){return function(t){t(null,n())}},C=function(n){return n=n||P,function(){null!==n&&(n.apply(this,arguments),n=null)}},F=function(n){return function(){null===n&&q("Callback was already called."),n.apply(this,arguments),n=null}},D=function(n,t,r,e){try{return n.apply(t,r)}catch(u){g._debugger&&g._debugger(u,A.apply(0,arguments)),e(u)}},H=function(n,t){try{return n(t)}catch(r){g._debugger&&g._debugger(r,A.apply(0,arguments)),t(r)}},z=function(n){return function(){var t=A.apply(0,arguments),r=t.pop(),e=!0;t.push(function(){var n=arguments,t=this;e?d(function(){r.apply(t,n)}):r.apply(t,n)});var u=n.apply(this,t);return e=!1,u}},B=function(n,t){t=F(t);var r=H(n,t);r&&typeof r.then===u&&typeof r["catch"]===u&&r["catch"](t).then(function(n){t(null,n)})},M=function(n,t){return v(t)&&v(n)?function(){var r,e=D(t,this,A.apply(0,arguments),function(n){r=n});r?n(r):m(e)?I(n,null):I(n,null,e)}:q(h[2])},Q=function(n,t){return v(t)&&v(n)?function(r){if(r)return n.apply(this,arguments);var r,e=D(t,this,A.apply(1,arguments),function(n){r=n});r?n(r):m(e)?I(n,null):I(n,null,e)}:q(h[2])},R=function(n,t){return m(t)||!v(n)?q(h[2]):function(r){return r?n.apply(this,arguments):v(t)?void D(t,this,A.apply(1,arguments),n):I(n,null,t)}},U=function(n,t){return m(n)?q(h[2]):function(){m(t)&&(t=n,n=arguments[arguments.length-1]),D(t,this,A.apply(0,arguments),n)}},W=function(n,t){return m(t)?q(h[2]):function(){var r=A.apply(0,arguments);r.push(t),D(n,this,r,t)}},G=function(n,t){return function(r){return m(t)&&(t=n,n=arguments[arguments.length-1]),r?n.apply(this,arguments):void D(t,this,arguments[1],n)}},J=function(n){return function(t){n.apply(this,t)}},K=function(){function n(){}function t(t,r){n.prototype=r.prototype,t.prototype=new n,t.prototype.constructor=r,n.prototype=null}function r(n,t){n.prototype=a.create(t.prototype,{constructor:{value:n,enumerable:!1}})}return a.create?r:t}(),N=function(n,t){var r=A.apply(2,arguments);return function(e){r.push(e),D(n[t],n,r,e)}},V=function(n,t,r){r=C(r);var e=k(t)?f(t.length):{};n(t,function(n,t,r){B(function(t){return n(t)},function(n){n||(0===arguments.length?e[t]=null:e[t]=arguments.length>2?A.apply(1,arguments):arguments[1]),r(n)})},function(n){n?r(n):r(null,e)})},X=function(n,t){if(!b(n))return q(h[0],t);t=C(t);var r,e=O(n);!function u(i){if(i)return t(i);if(null===(r=e()))return t.apply(this,arguments);var o=A.apply(1,arguments);B(function(t){return o.push(t),n[r].apply(this,o)},u)}()},Y=function(n,t,r,e,u){e=C(e);var i,o=O(n),c=n.length;!function f(t,a){return t?e(t):null===(i=o())?e(null,a):void B(function(t){return r(a,u?n[i]:n[c-1-i],t)},f)}(null,t)},Z=function(n){return n=w(n)||1/0,function(t,r,e){e=C(e);var u,i=0,o=!1,c=O(t),f=!1,a=r.length;!function s(){if(o&&0>=i)return e(null);for(;n>i&&!f;){if(u=c(),null===u)return o=!0,void(0>=i&&e(null));++i,B(function(n){return 2===a?r(t[u],n):r(t[u],u,n)},function(n){--i,n?(f=!0,e(n)):s()})}}()}},$=Z(1),nn=Z(1/0),tn=function(n,t,r,e){e=C(e),n(t,function(n,t,e){B(function(t){return r(n,t)},e)},function(n){e(n||null)})},rn=function(n,t,r,e){e=C(e);var u=k(t)?f(t.length):f(),i=-1;n(t,function(n,t,e){var o=++i;B(function(t){return r(n,t)},function(n,t){u[o]=t,e(n)})},function(n){n?e(n):e(null,u)})},en=function(n,t,r,e){e=C(e);var u=f(t.length);n(t,function(n,t,e){B(function(t){return r(n,t)},function(r,i){u[t]={e:n,i:i},e(r)})},function(n){n?e(n):e(null,j(u.sort(function(n,t){return n.i-t.i}),"e"))})},un=function(n,t,r,e){e=C(e);var u=f(t.length);n(t,function(n,t,e){B(function(t){return r(n,t)},function(n,r){u[t]=r,e(n)})},function(n){if(n)e(n);else{var t=[];S(u,function(n){t=t.concat(n)}),e(null,t)}})},on=function(n,t,r,e){t=w(t);for(var u=f(t),i=-1;++i<t;)u[i]=i;rn(n,u,r,e)},cn=function(n,t,r,e,u){u=C(u);var i=f();n(r,function(n,r,u){B(function(t){return e(n,t)},function(e,o){(t&&o||!t&&!o)&&i.push({e:n,i:r}),u(e)})},function(n){n?u(n):u(null,j(i.sort(function(n,t){return n.i-t.i}),"e"))})},fn=function(n,t,r,e){e=C(e);var u;n(t,function(n,t){B(function(t){return r(n,t)},function(r){r&&(u=n),t(u||null)})},function(){e(u)})},an=function(n,t,r,e,u){u=C(u);var i=t;n(r,function(n,r){B(function(t){return e(n,t)},function(n){t?(n||(i=!1),r(!n)):(n&&(i=!0),r(i))})},function(){u(i)})},sn=function(n){var t=[],r=this;return v(n)&&t.push(n),r.then=function(n){return t.push(n),r},r.done=function(n){X(t,n)},r},ln=function(n,t){var r,e={},u={},i=null,o=L(n).sort(function(t,r){return(k(n[t])?n[t].length:0)-(k(n[r])?n[r].length:0)}),c=o.length;return S(o,function(t){var r=n[t];if(k(r))for(var e,u=-1,o=r.length-1;++u<o;){if(e=n[r[u]],!e)return i="Has inexistant dependency",!1;if(e==t||k(e)&&-1!==e.indexOf(t))return i="Has cyclic dependencies",!1}}),i?q(i,t):(t=C(t),void function f(){S(o,function(i){if(r)return!1;if(!u[i]){var o,a=n[i];if(k(a)){for(var s=-1,l=a.length-1;++s<l;)if(!y.call(e,a[s]))return;o=a[l]}else o=a;u[i]=1,B(function(n){return o(n,e)},function(n){return--c,r?void 0:(r=n||0===c,n?t(n,e):(arguments.length>1?e[i]=arguments.length>2?A.apply(1,arguments):arguments[1]:e[i]=null,r?t(n,e):void f()))})}})}())},pn=function(n,t,r,e,u){function i(){B(t,R(u,o))}function o(){B(n,R(u,function(n){n==r?u(null):i()}))}e?o():i()},yn=function(n,t){t=F(t),n=z(n),function r(){n(o.sure(t,r))}()},hn=function(n){var t=A.apply(1,arguments);return function(){t=t.concat(A.apply(0,arguments)),n.apply(this,t)}},gn=function(n,t,r){function e(e,o){$(f(n),function(n,r){B(function(n){return t(n)},function(n,t){u=n,i=t,r(!n)},o)},function(){(e||r||P)(u||null,i)})}var u,i;return v(n)?(r=t,t=n,n=5):n=w(n)||5,r?e():e},dn=function(n,t){var r=this;if(a.defineProperties?a.defineProperties(r,{__worker:{enumerable:!1,configurable:!1,writable:!1,value:n},__workers:{enumerable:!1,configurable:!1,writable:!0,value:0},tasks:{enumerable:!1,configurable:!1,writable:!0,value:[]}}):(r.__worker=n,r.__workers=0,r.tasks=[]),null==t)t=1;else{if(0===t)return q("Concurrency must not be zero");r.concurrency=w(t)}r.started=!1,r.paused=!1};dn.prototype.saturated=P,dn.prototype.empty=P,dn.prototype.drain=P,dn.prototype.kill=function(){this.drain=P,this.tasks=[]},dn.prototype.length=function(){return this.tasks.length},dn.prototype.running=function(){return this.__workers},dn.prototype.idle=function(){return this.tasks.length+this.__workers===0},dn.prototype.pause=function(){this.paused=!0},dn.prototype.resume=function(){var n=this;if(n.paused!==!1){n.paused=!1;for(var t=0,r=O(n.tasks);++t<=n.concurrency&&null!==r();)n.__execute()}},dn.prototype.__insert=function(n,t,r){if(null!=r&&typeof r!==u)return q(h[3]);var e=this;if(e.started=!0,k(n)||(n=[n]),0===n.length)return e.drain();var i=n.length,o=e.tasks.length,c=-1,f=j(n,function(n,e){return{data:n,priority:t,callback:F(v(r)?r:P)}});if(o)if(e instanceof vn){var a=o?e.tasks[0].priority:0,s=o?e.tasks[o-1].priority:0;t>a?e.tasks=f.concat(e.tasks):e.tasks=e.tasks.concat(f),a>=t&&s>t&&e.tasks.sort(function(n,t){return t.priority-n.priority})}else t?e.tasks=f.concat(e.tasks):e.tasks=e.tasks.concat(f);else e.tasks=f;for(;++c<i&&!e.paused;)e.__execute()};var vn=function(n,t){dn.call(this,n,t)},mn=function(n,t){dn.call(this,n,t)},_n=function(n,t){dn.call(this,n,1),this.payload=t};K(vn,dn),K(mn,dn),K(_n,dn),vn.prototype.push=function(n,t,r){this.__insert(n,t,r)},mn.prototype.push=_n.prototype.push=function(n,t){this.__insert(n,!1,t)},mn.prototype.unshift=function(n,t){this.__insert(n,!0,t)},mn.prototype.__execute=vn.prototype.__execute=function(){var n=this;if(!n.paused&&n.__workers<n.concurrency&&0!==n.tasks.length){var t=n.tasks.shift();0===n.tasks.length&&n.empty(),++n.__workers,n.__workers===n.concurrency&&n.saturated();var r=F(function(){--n.__workers,t.callback.apply(t,arguments),n.tasks.length+n.__workers===0&&n.drain(),n.__execute()});B(function(r){return n.__worker.call(t,t.data,r)},r)}},_n.prototype.__execute=function(){var n=this;if(!n.paused&&n.__workers<n.concurrency&&0!==n.tasks.length){var t=n.tasks.splice(0,n.payload);0===n.tasks.length&&n.empty();var r=j(t,"data");++n.__workers,n.__workers===n.concurrency&&n.saturated();var e=F(function(){--n.__workers;var r=arguments;S(t,function(n){n.callback.apply(n,r)}),n.tasks.length+n.__workers===0&&n.drain(),n.__execute()});B(function(t){return n.__worker.call(null,r,t)},e)}},o.noop=P,o["yield"]=d,o.back=o.setImmediate=o.nextTick=I,o.apply=hn,o.async=N,o.inherits=K,o.args=A,o.ensureAsync=z,o.setDebugger=function(n){g._debugger=v(n)?n:!1},o.constant=function(){var n=A.apply(-1,arguments);return n[0]=null,function(t){return t.apply(this,n)}},o.result=function(n,t){return M(n,t)},o.sure_result=o.trap_sure_result=function(n,t){return Q(n,t)},o.sure=o.trap_sure=function(n,t){return R(n,t)},o.trap=function(n,t){return U(n,t)},o.wrap=function(n,t){return W(n,t)},o.run=function(n,t){B(n,t)},o.sure_spread=function(n,t){return G(n,t)},o.spread=function(n){return J(n)},o.chain=function(n){return new sn(n)},o.each=o.forEach=function(n,t,r){return k(n)?void tn(nn,n,t,r):q(h[1],r)},o.eachLimit=o.forEachLimit=function(n,t,r,e){return k(n)?void tn(Z(t),n,r,e):q(h[1],e)},o.eachSeries=o.forEachSeries=function(n,t,r){return k(n)?void tn($,n,t,r):q(h[1],r)},o.forEachOf=function(n,t,r){return b(n,r)?void nn(n,t,r):q(h[0],r)},o.forEachOfLimit=function(n,t,r,e){return b(n)?void Z(t)(n,r,e):q(h[0],e)},o.forEachOfSeries=function(n,t,r){return b(n)?void Z(1)(n,t,r):q(h[0],r)},o.map=function(n,t,r){return b(n)?void rn(nn,n,t,r):q(h[0],r)},o.mapLimit=function(n,t,r,e){return b(n)?void rn(Z(t),n,r,e):q(h[0],e)},o.mapSeries=function(n,t,r){return b(n)?void rn($,n,t,r):q(h[0],r)},o.concat=function(n,t,r){return k(n)?void un(nn,n,t,r):q(h[1],r)},o.concatLimit=function(n,t,r,e){return k(n)?void un(Z(t),n,r,e):q(h[1],e)},o.concatSeries=function(n,t,r){return k(n)?void un($,n,t,r):q(h[1],r)},o.sortBy=function(n,t,r){return k(n)?void en(nn,n,t,r):q(h[1],r)},o.filter=o.select=function(n,t,r){return k(n)?void cn(nn,1,n,t,r):q(h[1],r)},o.filterLimit=o.selectLimit=function(n,t,r,e){return k(n)?void cn(Z(t),1,n,r,e):q(h[1],e)},o.filterSeries=o.selectSeries=function(n,t,r){return k(n)?void cn($,1,n,t,r):q(h[1],r)},o.reject=function(n,t,r){return k(n)?void cn(nn,0,n,t,r):q(h[1],r)},o.rejectLimit=function(n,t,r,e){return k(n)?void cn(Z(t),0,n,r,e):q(h[1],e)},o.rejectSeries=function(n,t,r){return k(n)?void cn($,0,n,t,r):q(h[1],r)},o.waterfall=function(n,t){X(n,t)},o.series=function(n,t){V($,n,t)},o.parallel=function(n,t){V(nn,n,t)},o.parallelLimit=function(n,t,r){V(Z(t),n,r)},o.auto=function(n,t){ln(n,t)},o.whilst=function(n,t,r){pn(T(n),t,!1,!0,r)},o.doWhilst=function(n,t,r){pn(T(t),n,!1,!1,r)},o.during=function(n,t,r){pn(n,t,!1,!0,r)},o.doDuring=function(n,t,r){pn(t,n,!1,!1,r)},o.until=function(n,t,r){pn(T(n),t,!0,!0,r)},o.doUntil=function(n,t,r){pn(T(t),n,!0,!1,r)},o.forever=function(n,t){yn(n,t)},o.reduce=o.inject=o.foldl=function(n,t,r,e){return k(n)?void Y(n,t,r,e,1):q(h[1],e)},o.reduceRight=o.foldr=function(n,t,r,e){return k(n)?void Y(n,t,r,e,0):q(h[1],e)},o.queue=function(n,t){return new mn(n,t)},o.priorityQueue=function(n,t){return new vn(n,t)},o.cargo=function(n,t){return new _n(n,t)},o.retry=function(n,t,r){return gn(n,t,r)},o.times=function(n,t,r){on(Z(n),n,t,r)},o.timesLimit=function(n,t,r,e){on(Z(t),n,r,e)},o.timesSeries=function(n,t,r){on($,n,t,r)},o.detect=function(n,t,r){fn(nn,n,t,r)},o.detectLimit=function(n,t,r,e){fn(Z(t),n,r,e)},o.detectSeries=function(n,t,r){fn($,n,t,r)},o.some=o.any=function(n,t,r){an(nn,!1,n,t,r)},o.someLimit=o.anyLimit=function(n,t,r,e){an(Z(t),!1,n,r,e)},o.someSeries=o.anySeries=function(n,t,r){an($,!1,n,t,r)},o.every=o.all=function(n,t,r){an(nn,!0,n,t,r)},o.everyLimit=o.allLimit=function(n,t,r,e){an(Z(t),!0,n,r,e)},o.everySeries=o.allSeries=function(n,t,r){an($,!0,n,t,r)},o.applyEach=n(nn),o.applyEachSeries=n($),typeof module===e&&typeof module.exports===e?module.exports=o:typeof define===u&&define.amd?define([],function(){return o}):c.safe=o}();